<UserControl x:Class="MesTechStok.Desktop.Components.LoadingSpinner"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="100" d:DesignWidth="100">
    
    <UserControl.Resources>
        <!-- Spinning Animation -->
        <Storyboard x:Key="SpinAnimation" RepeatBehavior="Forever">
            <DoubleAnimation Storyboard.TargetName="SpinnerRing"
                           Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)"
                           From="0" To="360" Duration="0:0:1"/>
        </Storyboard>
        
        <!-- Pulse Animation -->
        <Storyboard x:Key="PulseAnimation" RepeatBehavior="Forever" AutoReverse="True">
            <DoubleAnimation Storyboard.TargetName="SpinnerRing"
                           Storyboard.TargetProperty="Opacity"
                           From="1" To="0.3" Duration="0:0:0.8"/>
        </Storyboard>
        
        <!-- Fade In Animation -->
        <Storyboard x:Key="FadeInAnimation">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.3"/>
        </Storyboard>
        
        <!-- Fade Out Animation -->
        <Storyboard x:Key="FadeOutAnimation">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="1" To="0" Duration="0:0:0.3"/>
        </Storyboard>
    </UserControl.Resources>
    
    <Grid x:Name="LoadingContainer">
        <Grid.RenderTransform>
            <ScaleTransform ScaleX="1" ScaleY="1"/>
        </Grid.RenderTransform>
        
        <!-- Background Overlay -->
        <Rectangle Fill="{StaticResource SurfaceWhiteBrush}" 
                  Opacity="0.9" 
                  Visibility="{Binding ShowBackground, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
        
        <!-- Main Loading Content -->
        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
            
            <!-- Modern Spinner Ring -->
            <Grid Width="{Binding SpinnerSize, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                  Height="{Binding SpinnerSize, RelativeSource={RelativeSource AncestorType=UserControl}}"
                  Margin="0,0,0,16">
                
                <!-- Outer Ring -->
                <Ellipse x:Name="SpinnerRing"
                        Width="{Binding SpinnerSize, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                        Height="{Binding SpinnerSize, RelativeSource={RelativeSource AncestorType=UserControl}}"
                        Stroke="{StaticResource PrimaryBlueBrush}"
                        StrokeThickness="4"
                        StrokeDashArray="25 25"
                        Fill="Transparent"
                        RenderTransformOrigin="0.5,0.5">
                    <Ellipse.RenderTransform>
                        <RotateTransform Angle="0"/>
                    </Ellipse.RenderTransform>
                </Ellipse>
                
                <!-- Inner Glow -->
                <Ellipse Width="{Binding InnerGlowSize, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                        Height="{Binding InnerGlowSize, RelativeSource={RelativeSource AncestorType=UserControl}}"
                        Fill="{StaticResource PrimaryBlueBrush}"
                        Opacity="0.1"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"/>
                
                <!-- Center Icon -->
                <TextBlock Text="{Binding CenterIcon, RelativeSource={RelativeSource AncestorType=UserControl}}"
                          FontSize="{Binding IconSize, RelativeSource={RelativeSource AncestorType=UserControl}}"
                          Foreground="{StaticResource PrimaryBlueBrush}"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          FontWeight="Bold"/>
            </Grid>
            
            <!-- Loading Text -->
            <TextBlock Text="{Binding LoadingText, RelativeSource={RelativeSource AncestorType=UserControl}}"
                      Style="{StaticResource BodyTextStyle}"
                      HorizontalAlignment="Center"
                      Margin="0,0,0,8"
                      Visibility="{Binding ShowLoadingText, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
            
            <!-- Progress Text -->
            <TextBlock Text="{Binding ProgressText, RelativeSource={RelativeSource AncestorType=UserControl}}"
                      Style="{StaticResource CaptionStyle}"
                      HorizontalAlignment="Center"
                      Visibility="{Binding ShowProgressText, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BooleanToVisibilityConverter}}"/>
        </StackPanel>
        
        <!-- Auto-start animations -->
        <Grid.Triggers>
            <EventTrigger RoutedEvent="Loaded">
                <BeginStoryboard Storyboard="{StaticResource SpinAnimation}"/>
                <BeginStoryboard Storyboard="{StaticResource FadeInAnimation}"/>
            </EventTrigger>
        </Grid.Triggers>
    </Grid>
</UserControl> 